See http://www.thelowlyprogrammer.com/2010/04/indexing-and-enumerating-subsets-of.html for a description and analysis of the algorithm implemented here. 

C# port provided by Ligon Liu.